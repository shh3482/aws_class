<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/layout.html}">
<head>
<meta charset="UTF-8">
<title>abc</title>
</head>
<body>
	<main layout:fragment="content" class="container">
		<h1>게시글 상세</h1>
		<div class="form-control" th:text="${post.po_title}"></div>
		<div class="input-group mt-3">
			<div class="form-control" th:text="${post.po_me_id}"></div>
			<div class="form-control" th:text="${post.po_view}"></div>
			<div class="form-control" th:text="${post.po_date}"></div>
		</div>
		<pre class="form-control mt-3" th:text="${post.po_content}"
			style="min-height: 400px"></pre>
		<!-- 게시글 삭제 버튼 -->
		<form class="mt-3"
			th:action="@{/post/delete/{num}(num=${post.po_num})}" method="post"
			onsubmit="return confirm('게시글을 삭제하겠습니까?');"
			th:if="${#authentication.name == post.po_me_id}">
			<button class="btn btn-danger">삭제</button>
			<a th:href="@{/post/update/{num}(num=${post.po_num})}"
				class="btn btn-warning">수정</a>
		</form>

		<hr>
		<a th:href="@{/post/list}" class="btn btn-outline-success mt-3">목록으로</a>
		
		<!-- 화면에 댓글 목록 출력 -->

		<!-- /post/detail 에 fetch url: /api/v1/posts/번호/comments get방식 -->
		<script type="text/javascript">
			async function getComments() {
				const postNum = [[${post.po_num}]];
				try {
					const response = await fetch(`/api/v1/posts/${postNum}/comments`);

					if (response.ok) {
						const comments = await response.json();
						console.log(comments)
					} else {
						const errorText = await
						response.text();
						alert("서버 오류: " + errorText);
					}

				} catch (error) {
					console.error("통신 중 오류 발생:", error);
					alert("통신에 실패했습니다.");
				}
			}
			getComments();
		</script>
	</main>
</body>
</html>



